<!doctype html>
<html lang="vi">
<head th:replace="~{fragments/header :: header}"></head>
<body>
	<nav th:replace="~{fragments/topmenu :: topmenu}"></nav>
	<main th:if="${order == null}" role="main" class="container-fluid" style="margin-top: 60px;">
		<h4>Danh s√°ch order ch·ªù nh·∫∑t h√†ng!</h4>
	</main>
	<main th:if="${order != null}" role="main" class="container-fluid" style="margin-top: 56px;">
		<!-- Th√¥ng tin t·ªïng quan -->
		<div class="row mb-2" style="margin-top: 80px;">
			<div class="col-6 col-md-3 mb-2">
				<strong class="pr-2">Line:</strong> <span th:text="${order.workOrder.line}"></span>
			</div>
			<div class="col-6 col-md-3 mb-2 text-left text-lg-center">
				<strong class="pr-2">WorkOrder:</strong> <span th:text="${order.workOrder.woNumber}"></span>
			</div>
			<div class="col-6 col-md-3 mb-2 text-left text-lg-center">
				<strong class="pr-2">Model:</strong> <span th:text="${order.workOrder.model}"></span>
			</div>
			<div class="col-6 col-md-3 mb-2 text-md-right">
				<strong class="pr-2">K·∫ø ho·∫°ch:</strong> <span th:text="${order.workOrder.woQty}"></span>
			</div>
		</div>

		<!-- Th√¥ng tin b·ªï sung: Order name + Ng√†y t·∫°o -->
		<div class="row">
			<div class="col-12 mt-2 mb-3">
				<strong class="mr-2">Order:
					<span class="mr-5 text-success" th:text="${order.orderName}"></span>
				</strong>
				<strong>Created at:
					<span class="text-success" th:text="${#dates.format(order.createdDate, 'dd/MM ~ HH:mm')}"></span>
				</strong>
				<hr />
			</div>
		</div>

		<!-- Tabs -->
		<ul class="nav nav-tabs mb-3" id="pickingTabs" role="tablist">
			<li class="nav-item">
				<a class="nav-link active" id="instruction-tab" data-toggle="tab" href="#instruction" role="tab"
					aria-controls="instruction" aria-selected="true">
					üìã Picking Instructions
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" id="scan-tab" data-toggle="tab" href="#scan" role="tab" aria-controls="scan"
					aria-selected="false">
					üì¶ Scan & Pick Items
				</a>
			</li>
		</ul>

		<div class="tab-content" id="pickingTabContent">
			<!-- Tab 1: Picking Instructions -->
			<div class="tab-pane fade show active" id="instruction" role="tabpanel" aria-labelledby="instruction-tab">
				<!-- H∆∞·ªõng d·∫´n nh·∫∑t h√†ng -->
				<div class="card">
					<div class="card-body">
						<h5 class="card-title">üìç H∆∞·ªõng d·∫´n nh·∫∑t h√†ng</h5>

						<div class="table-responsive">
							<table class="table table-sm table-bordered table-hover text-nowrap">
								<thead class="thead-light text-center">
									<tr>
										<th>Category</th>
										<th>M√£ SP</th>
										<th>T√™n SP</th>
										<th>V·ªã tr√≠</th>
										<th>S·ªë l∆∞·ª£ng</th>
										<th>SerialNo</th>
										<th>Ng√†y nh·∫≠p</th>
										<th>Action</th>
									</tr>
								</thead>
								
								
								
								<tbody>
								  <th:block th:each="group, groupStat : ${pickingSuggestions}">
								    <!-- D√≤ng cha (lu√¥n hi·ªÉn th·ªã) -->
								    <tr th:class="'parent-row-' + ${groupStat.index}">
								      <td th:text="${group.itemCategory}"></td>
								      <td th:text="${group.itemCode}"></td>
									  <td th:text="${group.productName}"></td>
								      <td th:text="${group.items[0].locCode}"></td>
								      <td th:text="${group.items[0].qty}"></td>
								      <td th:text="${group.items[0].serialNo}"></td>
								      <td th:text="${#temporals.format(group.items[0].dateIn, 'dd/MM/yyyy')}"></td>
								      <td class="text-center">
								        <a href="javascript:void(0);" class="toggle-detail-btn" th:attr="data-index=${groupStat.index}">
								          <i class="fas fa-plus"></i>
								        </a>
								      </td>
								    </tr>

								    <!-- C√°c d√≤ng con (·∫©n theo m·∫∑c ƒë·ªãnh) -->
								    <tr th:each="item, itemStat : ${group.items}"
								        th:if="${itemStat.index > 0}"
								        th:id="'detail-row-' + ${groupStat.index} + '-' + ${itemStat.index}"
								        th:class="'d-none detail-row detail-group-' + ${groupStat.index} + ' ' + (${itemStat.index ge 6} ? 'extra-item d-none' : '')">
								      <td></td>
								      <td></td>
									  <td></td>
								      <td th:text="${item.locCode}"></td>
								      <td th:text="${item.qty}"></td>
								      <td th:text="${item.serialNo}"></td>
								      <td th:text="${#temporals.format(item.dateIn, 'dd/MM/yyyy')}"></td>
								      <td></td>
								    </tr>

								    <!-- D√≤ng link "Hi·ªÉn th·ªã th√™m..." -->
								    <tr th:if="${group.items.size() > 6}"
								        th:id="'show-more-row-' + ${groupStat.index}"
								        th:class="'d-none show-more-row detail-group-' + ${groupStat.index}">
								      <td colspan="8" class="text-center">
								        <a href="javascript:void(0);" class="show-more-link" th:attr="data-index=${groupStat.index}">
								          üîΩ Hi·ªÉn th·ªã th√™m...
								        </a>
								      </td>
								    </tr>
								  </th:block>
								  
								  
								  
								</tbody>
							</table>
						</div>

					</div>
				</div>
				<!-- End h∆∞·ªõng d·∫´n nh·∫∑t h√†ng -->
			</div>
			<!-- Tab 2: Scan & Pick Items -->
			<div class="tab-pane fade" id="scan" role="tabpanel" aria-labelledby="scan-tab">
				<div class="mt-3" th:replace="~{fragments/orderpicking/orderpicking_list :: orderpicking_list}"></div>
			</div>
		</div>
	</main>

	<!-- Scripts -->
	<script src="/bootstrap-4.6.2/js/jquery-3.5.1.min.js"></script>
	<script src="/bootstrap-4.6.2/js/bootstrap.bundle.min.js"></script>
	<script src="/dataTables/jquery.dataTables.min.js"></script>
	<script src="/js/picking_instruction.js?v=2"></script>
	<script src="/js/scan-serial.js?v=2"></script>
	<script src="/js/endpicking.js?v=2"></script>

</body>

</html>